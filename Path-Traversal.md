# üìú Description
Une attaque de path traversal (√©galement connue sous le nom de directory traversal) vise √† acc√©der √† des fichiers et des r√©pertoires situ√©s en dehors du dossier racine web. En manipulant des variables qui r√©f√©rencent des fichiers avec des s√©quences "dot-dot-slash (../)" et ses variations ou en utilisant des chemins de fichiers absolus, il peut √™tre possible d'acc√©der √† des fichiers et des r√©pertoires arbitraires stock√©s sur le syst√®me de fichiers, y compris le code source de l'application ou des fichiers de configuration et des fichiers syst√®me critiques.

Un exemple classique d'attaque par path traversal pour r√©cup√©rer des fichiers syst√®me est : `https://insecure-website.com/loadImage?filename=../../../etc/passwd`.

# üïµÔ∏è Proof of Concept
Dans votre application, le path traversal se produit lorsque **[REMPLIR ICI]**.

# üöß Impacts
Un attaquant pourrait effectuer des actions non pr√©vues par l'application, telles que lire, mettre √† jour ou supprimer des fichiers et r√©pertoires arbitraires stock√©s sur le syst√®me de fichiers, y compris le code source de l'application ou des fichiers de configuration et des fichiers syst√®me critiques.

# üîê Mitigations
La mani√®re la plus efficace de pr√©venir les vuln√©rabilit√©s de path traversal est d'√©viter de passer des entr√©es fournies par l'utilisateur aux API de syst√®me de fichiers. De nombreuses fonctions d'application qui font cela peuvent √™tre r√©√©crites pour offrir le m√™me comportement de mani√®re plus s√©curis√©e.

S'il est consid√©r√© comme in√©vitable de passer des entr√©es fournies par l'utilisateur aux API de syst√®me de fichiers, deux couches de d√©fense doivent √™tre utilis√©es ensemble pour pr√©venir les attaques :

- L'application doit valider les entr√©es utilisateur avant de les traiter. Id√©alement, la validation devrait se faire par comparaison avec une liste blanche de valeurs autoris√©es. Si cela n'est pas possible pour la fonctionnalit√© requise, alors la validation doit v√©rifier que l'entr√©e ne contient que du contenu autoris√©, tel que des caract√®res purement alphanum√©riques.
- Apr√®s avoir valid√© l'entr√©e fournie, l'application doit ajouter l'entr√©e au r√©pertoire de base et utiliser une API de syst√®me de fichiers de la plateforme pour canonicaliser le chemin. Elle doit v√©rifier que le chemin canonicalis√© commence par le r√©pertoire de base attendu.

Voici un exemple de code Java simple pour valider le chemin canonique d'un fichier bas√© sur une entr√©e utilisateur :

```java
File file = new File(BASE_DIRECTORY, userInput);
if (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) {
    // process file
}
```

En PHP, vous pouvez utiliser la fonction [basename](https://www.php.net/manual/en/function.basename.php) pour extraire le dernier √©l√©ment d'un chemin.

# üìö References
- [OWASP - Path Traversal](https://owasp.org/www-community/attacks/Path_Traversal)
- [PortSwigger - Path Traversal](https://portswigger.net/web-security/file-path-traversal)

Find more at : [French Web Pentest Reports](https://github.com/SofianeHamlaoui/french-web-pentest-reports)
